<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
        integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    <link rel="stylesheet" href="./../assets/css/app.css">
    <link rel="stylesheet" href="./../assets/css/vagas.css">
    <link rel="SHORTCUT ICON" href="https://www.spaceneedle.com.br/favicon.ico" type="image/x-icon" />
    <link href="https://fonts.googleapis.com/css?family=Open+Sans&display=swap" rel="stylesheet">
    <title>Quero Ser Space</title>
</head>

<body>
    <header class="cabecalho">
        <img class="logo" src="../assets/images/Space_Horizontal.png">
    </header>

    <div id="load" class="loader">
    </div>

    <div id="main" class="centro none">
        <div class="title">
            <h1>
                <span class="title-1">VAGAS </span>
                <span class="title-2">{DISPONÍVEIS}</span>
            </h1>
        </div>
        <section>
            <div class="container">
                <p id="emptyMessage" class="empty">No momento não temos vagas disponíveis...</p>
                <div id="cards" class="card-deck">
                <!-- vagas virão aqui -->
                </div>
            </div>
        </section>
        <div class="fundo"></div>
    </div>
</body>

<script>
    // let endpoint = 'https://i-wanna-be-space-storage.azurewebsites.net/api/downloads/$web/vagas/dados/';
    let endpoint = 'https://i-want-to-be-space.azurewebsites.net/api/downloads/$web?code=3YqezpHjI/U3GJYG5w3eEKg1S/WvA6QZm1sFNJf7sJnWvwoocgYbjQ==';

    if (window.location.host != "" && window.location.host != "localhost" && location.protocol != 'https:')
    {
        location.href = location.href.replace("http:", "https:")
    }

    fetch(endpoint,{
            method:'GET',
            headers: {
                'path': 'i-wanna-be-space/vagas/dados/'
            }
    })
        .then(response => {
        return response.json();
        })
        .then(items => {
            
            loaded();
            
            if(items.length === 0){
                document.getElementById('emptyMessage').style.display = 'block';
            }

            // controla o botão da div para mostrar cor sim cor não
            let color = false;
            // itera a lista de propriedades

            items.forEach(content => {

                content.data.forEach(element => {
                    if (element['key'] === 'titulo') {
                        color = !color;
                        let vagas = document.getElementById("cards");

                        // div principal do card
                        let div = document.createElement('div');
                        div.classList.add('card');

                        // div que contém a imagem
                        let divImageCard = document.createElement('div');
                        divImageCard.classList.add('img-image-card');
                        
                        div.appendChild(divImageCard);

                        // lógica da cor do SVG
                        let svgColor = color ? 'svg-1' : 'svg-2';

                        //Adicionando um svg no html                             
                        let svg_1 =
                            "<svg class='" + svgColor +
                            "' version='1.1'  xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px'" +
                            "viewBox='0 0 295.238 295.238' style='enable-background:new 0 0 295.238 295.238;' xml:space='preserve'>" +
                            "<path d='M277.462,0.09l-27.681,20.72l-27.838,64.905h-22.386l-8.79-19.048h5.743c10.505,0,19.048-8.452,19.048-18.957V28.571" +
                            "h9.524V0H196.51v28.571h9.524V47.71c0,5.248-4.271,9.433-9.524,9.433h-10.138L174.2,30.81l14.581-7.267L141.038,3.095" +
                            "l-11.224,39.281c-0.305-23.371-19.386-42.29-42.829-42.29c-23.633,0-42.857,19.224-42.857,42.857" +
                            "c0,14.281,7.233,27.676,19.048,35.595v7.176H51.643L50.9,89.619c-2.314,12.005-2.529,24.343-0.638,36.648l-32.486,57.905" +
                            "l35.876,8.195v60.014h47.619v42.857h114.286v-66.357c33.333-23.581,52.371-61.495,52.343-101.943l0.01-17.371" +
                            "c0-6.548-0.605-13.276-1.824-19.905l-0.705-3.948h-9.348l21.429-51.338V0.09z M206.033,19.138V9.614h9.524v9.524H206.033z" +
                            "M189.067,85.714h-18.062l-8.657-19.048h17.929L189.067,85.714z M147.219,16.119l18.929,8.11l-4.467,2.19l14.2,30.724h-17.862" +
                            "l-11.605-25.471l-4.262,2.152L147.219,16.119z M160.543,85.715h-21.176v-9.433c0-5.252,4.271-9.614,9.524-9.614h2.995v-0.001" +
                            "L160.543,85.715z M141.843,44.652l5.776,12.71c-9.905,0.667-17.776,8.848-17.776,18.919v9.433h-19.048v-7.176" +
                            "c9.529-6.386,15.995-16.352,18.176-27.452L141.843,44.652z M53.653,42.948c0-18.376,14.957-33.333,33.333-33.333" +
                            "c18.376,0,33.333,14.957,33.333,33.333c0,11.829-6.39,22.881-16.671,28.838l-2.376,1.371v12.557h-9.524V56.352" +
                            "c5.529-1.971,9.524-7.21,9.524-13.41c0-7.876-6.41-14.286-14.286-14.286c-7.876,0-14.286,6.411-14.286,14.287" +
                            "c0,6.2,3.995,11.438,9.524,13.41v29.362H72.7V73.157l-2.376-1.376C60.043,65.824,53.653,54.776,53.653,42.948z M86.986,47.71" +
                            "c-2.629,0-4.762-2.139-4.762-4.762c0-2.629,2.133-4.762,4.762-4.762c2.629,0,4.762,2.133,4.762,4.762S89.615,47.71,86.986,47.71z" +
                            "M257.366,95.239c0.691,4.761,1.039,9.59,1.039,14.285l0.01,17.405c0.029,38.148-18.795,73.871-50.286,95.552l-2.095,1.429" +
                            "v61.805h-95.238v-42.857h-47.62v-58.086l-30.862-7.043l27.876-49.7l-0.271-1.7c-1.771-10.419-1.871-21.567-0.333-31.09h3.59" +
                            "h47.619H257.366z M245.714,85.714H232.3l23.738-55.343l10.557,5.257L245.714,85.714z M267.938,25.714l-5.267-2.633l5.267-3.943V25.714z'/>" +
                            "<path d='M96.51,123.81c-7.876,0-14.286-4.762-14.286-14.286H72.7c0,14.286,10.681,23.81,23.81,23.81" +
                            "c13.129,0,23.81-9.524,23.81-23.81h-9.524C110.795,119.048,104.386,123.81,96.51,123.81z'/> </svg>"
                        divImageCard.innerHTML = svg_1

                        // botão mais detalhes
                        let divBody = document.createElement('div');
                        let title = document.createElement('h4');
                        title.classList.add('card-title');
                        title.innerText = element['value'];
                        divBody.appendChild(title);
                        divBody.classList.add('card-body');

                        let divBtn = document.createElement('ul');
                        divBtn.addEventListener("click", function () {
                            const domain = window.location.href.split("/")[0];
                            window.location.href = `${domain}/vaga?${content['id']}`
                        }, false);
                        // lógica da cor de fundo do botão
                        let c = color ? '1' : '2';
                        divBtn.classList.add('list-group', 'inscrever', 'fundo-card-' + c);
                        let p = document.createElement('p');
                        p.classList.add('card-text', 'dados-vaga')
                        p.innerText = 'MAIS INFORMAÇÕES';
                        divBtn.appendChild(p);

                        div.appendChild(divBody);
                        div.appendChild(divBtn);

                        vagas.appendChild(div);
                    }
                });
            })
          })
          .catch(error =>{
           return document.getElementById('emptyMessage').style.display = 'block';
        })

        function loaded() {
            let main = document.getElementById('main');
            let loader = document.getElementById('load');
            loader.remove('loader');
            main.classList.remove("none");
        }
        
</script>

</html>