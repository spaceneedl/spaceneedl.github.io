<!DOCTYPE html>
<html lang="pt-br">
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
        integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    <link rel="stylesheet" href="./../assets/css/app.css">
    <link rel="stylesheet" href="./../assets/css/perfil.css">
    <link rel="SHORTCUT ICON" href="https://www.spaceneedle.com.br/favicon.ico" type="image/x-icon" />
    <link href="https://fonts.googleapis.com/css?family=Open+Sans&display=swap" rel="stylesheet">
    <title>Quero Ser Space</title>
</head>

<body>
    <header class="cabecalho">
        <img class="logo" src="../assets/images/Space_Horizontal.png">
    </header>
    
    <div id="load" class="loader">
    </div>
    
    <div id="main" class="none">
        <section class="cards-centro container" class="row">
            <div class="card-perfil card">
                <div class="img-image-card-perfil ">
                    <svg class="svg-perfil" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg"
                        xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 511 511"
                        style="enable-background:new 0 0 511 511;" xml:space="preserve">
                        <path d="M327,144.521V127.5c0-3.119-0.934-6.021-2.526-8.455C331.372,107.041,335,93.481,335,79.5C335,35.664,299.336,0,255.5,0
		S176,35.664,176,79.5c0,13.982,3.628,27.542,10.526,39.545c-1.592,2.434-2.526,5.336-2.526,8.455v17.021
		c-27.067,3.675-48,26.921-48,54.979v96c0,23.925,17.78,43.775,40.821,47.032l14.297,114.372C173.351,460.76,160,476.596,160,495.5
		v8c0,4.142,3.358,7.5,7.5,7.5h64c8.547,0,15.5-6.953,15.5-15.5v-32v-96c0-4.687,3.813-8.5,8.5-8.5s8.5,3.813,8.5,8.5v96v32
		c0,8.547,6.953,15.5,15.5,15.5h64c4.142,0,7.5-3.358,7.5-7.5v-8c0-18.904-13.351-34.74-31.117-38.596l14.297-114.372
		C357.22,339.275,375,319.425,375,295.5v-96C375,171.442,354.067,148.195,327,144.521z M335,288v-65h25v65H335z M151,223h25v65h-25
		V223z M191,287h17v17h-17V287z M223,287h17v17h-17V287z M255,287h65v17h-65V287z M293.055,144c-2.647-4.765-7.728-8-13.555-8h-48
		c-5.827,0-10.908,3.235-13.555,8H199v-16.5c0-0.276,0.224-0.5,0.5-0.5h112c0.276,0,0.5,0.224,0.5,0.5V144H293.055z M231,151.5
		c0-0.276,0.224-0.5,0.5-0.5H248v8.5c0,4.142,3.358,7.5,7.5,7.5s7.5-3.358,7.5-7.5V151h16.5c0.275,0,0.499,0.223,0.5,0.498
		c0,0.001,0,0.001,0,0.002c0,0.003,0,0.006,0,0.01v7.99c0,9.098-7.402,16.5-16.5,16.5h-16c-9.098,0-16.5-7.402-16.5-16.5V151.5z
		 M255.5,15c35.565,0,64.5,28.935,64.5,64.5c0,11.51-3.032,22.663-8.785,32.5H199.784C194.032,102.164,191,91.011,191,79.5
		C191,43.935,219.935,15,255.5,15z M191.5,159H216v0.5c0,17.369,14.131,31.5,31.5,31.5h16c17.369,0,31.5-14.131,31.5-31.5V159h24.5
		c22.332,0,40.5,18.168,40.5,40.5v8.5h-25v-0.5c0-4.142-3.358-7.5-7.5-7.5s-7.5,3.358-7.5,7.5V272H191v-64.5
		c0-4.142-3.358-7.5-7.5-7.5s-7.5,3.358-7.5,7.5v0.5h-25v-8.5C151,177.168,169.168,159,191.5,159z M151.883,303H176v24.117
		C164.094,324.292,154.708,314.906,151.883,303z M232,495.5c0,0.276-0.224,0.5-0.5,0.5H175v-0.5c0-13.503,10.98-24.489,24.48-24.5
		c0.003,0,0.007,0,0.01,0c0.005,0,0.01-0.001,0.016-0.001H232V495.5z M255.5,344c-12.958,0-23.5,10.542-23.5,23.5V456h-25.879
		L191,335.035V319h17v8.5c0,4.142,3.358,7.5,7.5,7.5s7.5-3.358,7.5-7.5V319h17v8.5c0,4.142,3.358,7.5,7.5,7.5s7.5-3.358,7.5-7.5V319
		h65v16.035L304.879,456H279v-88.5C279,354.542,268.458,344,255.5,344z M336,495.5v0.5h-56.5c-0.276,0-0.5-0.224-0.5-0.5V471h32.494
		c0.005,0,0.01,0.001,0.016,0.001c0.003,0,0.007,0,0.01,0C325.02,471.011,336,481.997,336,495.5z M335,327.117V303h24.117
		C356.292,314.906,346.906,324.292,335,327.117z" />
                        <path d="M255.5,47c17.92,0,32.5,14.58,32.5,32.5c0,4.142,3.358,7.5,7.5,7.5s7.5-3.358,7.5-7.5c0-26.191-21.309-47.5-47.5-47.5
		c-4.142,0-7.5,3.358-7.5,7.5S251.358,47,255.5,47z" />
                        <path
                            d="M279.5,215h16c4.142,0,7.5-3.358,7.5-7.5s-3.358-7.5-7.5-7.5h-16c-4.142,0-7.5,3.358-7.5,7.5S275.358,215,279.5,215z" />
                        <path
                            d="M279.5,239h16c4.142,0,7.5-3.358,7.5-7.5s-3.358-7.5-7.5-7.5h-16c-4.142,0-7.5,3.358-7.5,7.5S275.358,239,279.5,239z" />
                    </svg>
                </div>

                <div class="card-body-perfil mb-4 ml-4 ">
                    <div class="margin-text-perfil">
                        <div id="personal-data" class="text-perfil mb-1">
                            <div class="title">
                                <h1 id="name"></h1>
                            </div>
                            <p class="card-text">E-mail: <a id="email"></a></p>
                        </div>
                        <div id="attachments">
                        </div>
                    </div>
                </div>
                <div id="anexos" class="">
                
                </div>
            </div>

            <section id="cards" class="card-deck">
                <!-- dados do candidato -->
            </section>

        </section>
        <div class="fundo"></div>
    </body>

<script>
    let id = window.location.search.substring(1);

    let endpoint = `https://i-wanna-be-space-storage.azurewebsites.net/download/$web/i-wanna-be-space/candidatos/dados/${id}`;

    if (window.location.host != "" && window.location.host != "localhost" && location.protocol != 'https:')
    {
        location.href = location.href.replace("http:", "https:")
    }

    
    if(id){
        fetch(endpoint,{
            method:'GET'
        })
        .then(response => {
            
            if(response.status == 404){
                const url = window.location.href.split("/")[0];
                window.location.href = url +'/notFound.html';
            }
            return response.json();
        })
        .then(items => {
            loaded();
            if (items.length === 0) {
                const url = window.location.href.split("/")[0];
                return window.location.href = url +'/notFound.html';
            }

            // controla o botão da div para mostrar cor sim cor não
            let color = false;
            items.data.forEach(content => {
                if (content['type'] == 'text') {
                    if (content['key'] === 'nome') {
                        let name = document.getElementById("name");
                        name.innerText = content['value'];
                    } else if (content['key'] === 'e-mail') {
                        let mail = document.getElementById("email");
                        mail.setAttribute('href', 'mailto:'+content['value']  +'?body='+window.location)
                        mail.innerText = content['value']

                    } else {
                        let div = document.getElementById('personal-data');
                        let data = document.createElement('p');
                        data.classList.add('card-text');
                        data.innerText = content['key'] + ': ';

                        let dataValue = document.createElement('span');
                        dataValue.innerText = content['value'];
                        data.appendChild(dataValue);
                        div.appendChild(data);
                    }

                } else if (content['type'] == 'file') {
                    let anexos = document.getElementById('anexos');

                    let mainDiv = document.createElement('div');
                    mainDiv.setAttribute('data-toggle', 'modal');
                    mainDiv.setAttribute('data-target', '#exampleModal');

                    mainDiv.classList.add('sombra-anexo');
                    let divImg = document.createElement('div');
                    let img = document.createElement('img');
                    img.classList.add('anexo-img');

                    img.setAttribute('src', '../../assets/images/file.png');
                    divImg.appendChild(img);
                    mainDiv.appendChild(divImg);


                    let divName = document.createElement('div');
                    let p = document.createElement('p');
                    p.innerText = content['key'];
                    divName.appendChild(p);
                    mainDiv.appendChild(divName);

                    mainDiv.onclick = function() {
                        var image = new Image(),
                        containerWidth = '20px',
                        containerHeight = '20px';

                        image.onload=function(){
                            containerWidth = image.width;
                            containerHeight = image.height;
                        }
                        image.src = content['value'];

                        var w = window.open("");
                        w.document.write(image.outerHTML);

                        var body = document.getElementsByTagName("BODY")[0];
                        body.appendChild(divModal);
           };

                    anexos.appendChild(mainDiv);
                    
                }else if(content['type'] == 'vaga'){
                        let cardDeckDiv = document.getElementById('cards');

                        let div = document.createElement('div');
                        div.classList.add('card');

                        // div que contém a imagem
                        let divImageCard = document.createElement('div');
                       

                        // lógica da cor do SVG
                        let svgColor = color ? 'svg-1' : 'svg-2';

                        //Adicionando um svg no html                             
                        let svg_1 =
                            "<svg class='" + svgColor +
                            "' version='1.1'  xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px'" +
                            "viewBox='0 0 295.238 295.238' style='enable-background:new 0 0 295.238 295.238;' xml:space='preserve'>" +
                            "<path d='M277.462,0.09l-27.681,20.72l-27.838,64.905h-22.386l-8.79-19.048h5.743c10.505,0,19.048-8.452,19.048-18.957V28.571" +
                            "h9.524V0H196.51v28.571h9.524V47.71c0,5.248-4.271,9.433-9.524,9.433h-10.138L174.2,30.81l14.581-7.267L141.038,3.095" +
                            "l-11.224,39.281c-0.305-23.371-19.386-42.29-42.829-42.29c-23.633,0-42.857,19.224-42.857,42.857" +
                            "c0,14.281,7.233,27.676,19.048,35.595v7.176H51.643L50.9,89.619c-2.314,12.005-2.529,24.343-0.638,36.648l-32.486,57.905" +
                            "l35.876,8.195v60.014h47.619v42.857h114.286v-66.357c33.333-23.581,52.371-61.495,52.343-101.943l0.01-17.371" +
                            "c0-6.548-0.605-13.276-1.824-19.905l-0.705-3.948h-9.348l21.429-51.338V0.09z M206.033,19.138V9.614h9.524v9.524H206.033z" +
                            "M189.067,85.714h-18.062l-8.657-19.048h17.929L189.067,85.714z M147.219,16.119l18.929,8.11l-4.467,2.19l14.2,30.724h-17.862" +
                            "l-11.605-25.471l-4.262,2.152L147.219,16.119z M160.543,85.715h-21.176v-9.433c0-5.252,4.271-9.614,9.524-9.614h2.995v-0.001" +
                            "L160.543,85.715z M141.843,44.652l5.776,12.71c-9.905,0.667-17.776,8.848-17.776,18.919v9.433h-19.048v-7.176" +
                            "c9.529-6.386,15.995-16.352,18.176-27.452L141.843,44.652z M53.653,42.948c0-18.376,14.957-33.333,33.333-33.333" +
                            "c18.376,0,33.333,14.957,33.333,33.333c0,11.829-6.39,22.881-16.671,28.838l-2.376,1.371v12.557h-9.524V56.352" +
                            "c5.529-1.971,9.524-7.21,9.524-13.41c0-7.876-6.41-14.286-14.286-14.286c-7.876,0-14.286,6.411-14.286,14.287" +
                            "c0,6.2,3.995,11.438,9.524,13.41v29.362H72.7V73.157l-2.376-1.376C60.043,65.824,53.653,54.776,53.653,42.948z M86.986,47.71" +
                            "c-2.629,0-4.762-2.139-4.762-4.762c0-2.629,2.133-4.762,4.762-4.762c2.629,0,4.762,2.133,4.762,4.762S89.615,47.71,86.986,47.71z" +
                            "M257.366,95.239c0.691,4.761,1.039,9.59,1.039,14.285l0.01,17.405c0.029,38.148-18.795,73.871-50.286,95.552l-2.095,1.429" +
                            "v61.805h-95.238v-42.857h-47.62v-58.086l-30.862-7.043l27.876-49.7l-0.271-1.7c-1.771-10.419-1.871-21.567-0.333-31.09h3.59" +
                            "h47.619H257.366z M245.714,85.714H232.3l23.738-55.343l10.557,5.257L245.714,85.714z M267.938,25.714l-5.267-2.633l5.267-3.943V25.714z'/>" +
                            "<path d='M96.51,123.81c-7.876,0-14.286-4.762-14.286-14.286H72.7c0,14.286,10.681,23.81,23.81,23.81" +
                            "c13.129,0,23.81-9.524,23.81-23.81h-9.524C110.795,119.048,104.386,123.81,96.51,123.81z'/> </svg>"
                        divImageCard.innerHTML = svg_1;

                        div.appendChild(divImageCard);

                        // botão mais detalhes
                        let divBody = document.createElement('div');
                        let title = document.createElement('h4');
                        title.innerText = content['value'];
                        divBody.appendChild(title);
                        divBody.classList.add('card-body');

                        let divBtn = document.createElement('div');

                        // lógica da cor de fundo do botão
                        let c = color ? '1' : '2';
                        color = !color
                        divBtn.classList.add('inscrever', 'fundo-card-' + c);

                        let feedbackId = items.data.indexOf(content) +1;
                        let feedback = items.data[feedbackId];

                        divBtn.addEventListener("click", function() {
                            const url = window.location.href.split("/")[0];
                            window.location.href = `${url}/feedbacks?${feedback['value']}`;
                        });

                        divBody.appendChild(divBtn);
                        let p = document.createElement('p');
                        p.classList.add('card-text', 'dados-vaga')
                        p.innerText = 'VER FEEDBACK';
                        divBtn.appendChild(p);

                        div.appendChild(divBody);

                        cardDeckDiv.appendChild(div);

                        // formatação
                        let divBlock = document.createElement('div');
                        divBlock.classList.add('w-1000', 'd-none', 'd-sm-block', 'd-md-none');
                        cardDeckDiv.appendChild(divBlock);
                }
            })
        })
    }else{
        const url = window.location.href.split("/")[0];
        window.location.href = url +'/notFound.html';
    }
       
    function loaded() {
        let main = document.getElementById('main');
        let loader = document.getElementById('load');
        loader.remove('loader');
        main.classList.remove("none");
    }
</script>

</html>